import{j as e,p as Ne,u as Te,a as Ce,b as Ee}from"./web3-vendor-COYj-tgc.js";import{r,u as Se}from"./react-vendor-BTPJ9MfQ.js";import{u as Pe,B as d}from"./index-i1UpOcxf.js";import{u as Ie,d as Ae,g as De,e as Fe,L as Ue,F as $e}from"./Layout-XKtbstTa.js";import{S as Me}from"./SEO-B8zD07Wz.js";import{u as Le,e as Oe}from"./api-Y8mGTqrB.js";import{u as Re}from"./useEmbeddedWallet-CKasTbql.js";import{X as Be}from"./x-p2MgApUF.js";import{F as We}from"./CloudArrowUpIcon-DE7L2IEJ.js";function He({title:c,titleId:u,...m},n){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":u},m),c?r.createElement("title",{id:u},c):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m4.5 15.75 7.5-7.5 7.5 7.5"}))}const Ye=r.forwardRef(He);function Ve({title:c,titleId:u,...m},n){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":u},m),c?r.createElement("title",{id:u},c):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"}))}const ae=r.forwardRef(Ve),ze=["ETH"],_e={ETH:18,DAI:18,USDC:6,USDT:6},oe={ETH:"/tokens/eth.png",DAI:"/tokens/dai.png",USDC:"/tokens/usdc.png",USDT:"/tokens/usdt.png"},Ke=({onConfirm:c,onCancel:u,tokenSymbol:m,onTokenChange:n})=>{const[P,g]=r.useState(""),[b,v]=r.useState(m),[F,l]=r.useState(!1),k=r.useRef(null);r.useEffect(()=>{v(m)},[m]),r.useEffect(()=>{const a=I=>{k.current&&!k.current.contains(I.target)&&l(!1)};return document.addEventListener("mousedown",a),()=>document.removeEventListener("mousedown",a)},[]);const j=()=>{const a=P.trim()===""?"0":P,I=_e[b],A=Ne(a,I);c(A,b)},O=a=>{v(a),l(!1),n==null||n(a)};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-2 sm:p-4",children:e.jsxs("div",{className:"flex-col bg-[var(--card)] p-4 sm:p-6 rounded-lg shadow-xl w-full max-w-xs sm:max-w-sm relative",children:[e.jsx("button",{onClick:u,className:"absolute top-2 right-2 text-gray-400 hover:text-white transition-colors","aria-label":"Close",children:e.jsx(Be,{size:18})}),e.jsxs("h2",{className:"text-sm font-bold text-white mb-2",children:["How many ",b," do you want to buy?"]}),e.jsxs("p",{className:"text-[10px] sm:text-xs text-gray-400 mb-3 italic leading-tight",children:["Tip: It's optional, but buying a small amount helps protect your coin from snipers. When creating, creators can buy up to 5% of the trading supply; any excess ",b," is refunded."]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Amount"}),e.jsx("input",{type:"number",inputMode:"decimal",value:P,onChange:a=>g(a.target.value),className:"w-full py-2 px-3 bg-[var(--card2)] border border-[var(--card-boarder)] rounded-md text-white text-xs focus:outline-none focus:ring-2 focus:ring-[var(--primary)] focus:border-[var(--primary)] transition-colors",placeholder:"0.0 (optional)"})]}),e.jsxs("div",{className:"flex-1 mt-2 relative",ref:k,children:[e.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Token"}),e.jsxs("button",{type:"button",onClick:()=>l(!F),className:"w-full flex items-center justify-between rounded-md border border-[var(--card-boarder)] bg-[var(--card2)] text-white px-3 py-2 text-xs focus:outline-none focus:ring-2 focus:ring-[var(--primary)]",children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("img",{src:oe[b],alt:b,className:"h-4 w-4"}),b]}),e.jsx("span",{children:"â–¾"})]}),F&&e.jsx("ul",{className:"absolute mt-1 w-full rounded-md border border-[var(--card-boarder)] bg-[var(--card2)] shadow-lg z-50",children:ze.map(a=>e.jsxs("li",{onClick:()=>O(a),className:"flex items-center gap-2 px-3 py-2 cursor-pointer hover:bg-[var(--card-hover)] text-xs text-white",children:[e.jsx("img",{src:oe[a],alt:a,className:"h-4 w-4"}),a]},a))})]}),e.jsxs("div",{className:"flex justify-end space-x-3 mb-3 mt-2",children:[e.jsx("button",{onClick:u,className:"px-3 py-1.5 bg-[var(--card2)] text-white rounded-md text-xs sm:text-sm hover:bg-[var(--card-hover)] transition-colors",children:"Cancel"}),e.jsx("button",{onClick:j,className:"px-3 py-1.5 bg-[var(--primary)] text-black rounded-md text-xs sm:text-sm hover:bg-[var(--primary-hover)] transition-colors",children:"Confirm"})]}),e.jsx("p",{className:"text-[8px] sm:text-xs text-gray-400 text-center",children:"Cost to deploy: ~0 ETH"})]})})},qe=({isOpen:c,onClose:u,children:m})=>c?e.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-50 p-4",onClick:u,children:e.jsx("div",{className:"glass rounded-xl shadow-2xl max-w-md w-full mx-4 border border-[var(--card-boarder)] hover:border-[var(--primary)] transition-all duration-300",onClick:n=>n.stopPropagation(),children:e.jsx("div",{className:"p-6",children:m})})}):null,Ge=50*1024*1024,ot=()=>{const[c,u]=r.useState("ETH"),m=Se(),[n,P]=r.useState(""),[g,b]=r.useState(""),[v,F]=r.useState(""),[l,k]=r.useState(),[j,O]=r.useState(null),[a,I]=r.useState(""),[A,ne]=r.useState(""),[R,le]=r.useState(""),[B,ie]=r.useState(""),[W,de]=r.useState(""),[_,K]=r.useState(!1),[p,N]=r.useState("idle"),[H,ce]=r.useState(!1),[ue,q]=r.useState(!1),[me,Y]=r.useState(!1),[G,V]=r.useState(!1),xe=r.useRef(null),{createToken:X,isLoading:Z,UserRejectedRequestError:pe}=Ie(),{approveTokens:J,isPending:Q}=Ae(),{address:T}=Te(),he=Ce(),D=Ee(),{isEmbeddedWallet:U,walletAddress:C}=Re(),{token:ee}=Pe(),fe=()=>ee||localStorage.getItem("auth_token"),te=r.useCallback(async t=>{if(t.size>Ge)return d.error("File size exceeds 50MB limit. Please choose a smaller file."),null;const o=t.type.startsWith("image/"),x=t.type.startsWith("video/");if(!o&&!x)return d.error("Please upload an image or video file."),null;K(!0),N("uploading");try{const i=await Le(t);if(i.url){k(i.url);const M=i.type||(o?"image":"video");return O(M),d.success(`${o?"Image":"Video"} uploaded successfully!`),i.url}else throw new Error("No URL returned from server")}catch(i){return i instanceof Error?d.error(`Failed to upload ${o?"image":"video"}: ${i.message}`):d.error(`Failed to upload ${o?"image":"video"}. Please try again.`),null}finally{K(!1),N("idle")}},[]),$=r.useCallback(async t=>{const o=await te(t);console.log(o),o&&k(o)},[te]),be=r.useCallback(t=>{t.target.files&&t.target.files[0]&&$(t.target.files[0])},[$]),ge=r.useCallback(t=>{t.preventDefault(),t.stopPropagation()},[]),ve=r.useCallback(t=>{t.preventDefault(),t.stopPropagation(),t.dataTransfer.files&&t.dataTransfer.files[0]&&$(t.dataTransfer.files[0])},[$]),ye=r.useCallback(async t=>{if(t.preventDefault(),!l){d.error("Please upload an image or video before creating the token.");return}Y(!0)},[l]),we=r.useCallback(async(t,o)=>{var M,se;Y(!1),N("creating");let x,i;try{const h=fe();if(U&&!T&&C&&h){const f=await fetch("/api/tokens/create-with-embedded-wallet",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${h}`},body:JSON.stringify({name:n,symbol:g,description:v,uri:l,initialPurchaseAmount:t.toString(),paymentToken:o,chainId:D})});if(!f.ok){const s=await f.json();if((M=s.error)!=null&&M.includes("Insufficient balance")&&s.address){const S=`${s.error}

Your embedded wallet address is: ${s.address}

Please send ETH to this address to create tokens.

View on explorer: ${s.explorerUrl||`https://sepolia.basescan.org/address/${s.address}`}`;throw new Error(S)}throw new Error(s.error||s.message||"Failed to create token")}x=await f.json(),i=x.tokenAddress}else{if(!T&&!U)throw new Error("Please connect a wallet to create a token");if(o!=="ETH"&&T){const s={DAI:"0x6B175474E89094C44Da98b954EedeAC495271d0F",USDC:"0xa0b86991c6218b36c1d19d4a2e9eb0ce3606eb48",USDT:"0xdac17f958d2ee523a2206206994597c13d831ec7"}[o],S=De(D),L=await Fe(s,T,S);(!L||L<t)&&await J(s)}x=await X(n,g,v,l,t,o),i=x==null?void 0:x.tokenAddress}let y=x==null?void 0:x.creator;if(!i)throw console.warn("Token address not found in event, but transaction succeeded"),new Error("Token created but address could not be extracted. Please check the transaction on the block explorer.");if(N("updating"),!i||!l)throw new Error("Token address or image URL is missing");const E=5,w=2e3;let z=null;for(let f=1;f<=E;f++)try{await Oe(i,{creatorAddress:y,name:n,symbol:g,logo:l,description:v,website:a,telegram:A,discord:R,twitter:B,youtube:W,chainId:D}),console.log(`Token metadata updated successfully on attempt ${f}`);break}catch(s){z=s;const S=(s==null?void 0:s.message)||String(s);if(f<E&&(((se=s==null?void 0:s.response)==null?void 0:se.status)===404||S.includes("not found")||S.includes("Token not found"))){console.log(`Token not found in backend yet, retrying in ${w}ms... (attempt ${f}/${E})`),await new Promise(L=>setTimeout(L,w));continue}throw s}if(z&&z.message.includes("not found"))throw new Error("Failed to update token metadata. The token may have been created on the blockchain, but the backend could not process it. Please try updating the token information later from your portfolio.");N("completed"),d.success("Token created and updated successfully!"),m(`/token/${D}/${i}`)}catch(h){if(console.error("Error in handlePurchaseConfirm:",h),N("idle"),V(!1),h instanceof Error)if(h instanceof pe)d.error("Transaction was cancelled. Please try again.");else if(i)d.error("Token created on blockchain but failed to update in backend. Please try updating later in your portfolio.");else{const y=h.message||"Unknown error";if(y.includes("Insufficient balance")){const E=y.match(/Your embedded wallet address is: (0x[a-fA-F0-9]{40})/);if(E){const w=E[1];d.error(`Insufficient Balance

Your embedded wallet address:
${w}

Please send ETH to this address to create tokens.`,{autoClose:1e4})}else{const w=(h==null?void 0:h.address)||C;w?d.error(`Insufficient Balance

Your embedded wallet address:
${w}

Please send ETH to this address to create tokens.`,{autoClose:1e4}):d.error(y,{autoClose:1e4})}}else y.includes("TokenCreated event not found")||y.includes("transaction succeeded")?d.error("Token was created but we could not extract the address. Please check your wallet for the transaction hash and contact support."):d.error(y,{autoClose:8e3})}else d.error("An unexpected error occurred. Please try again.")}},[n,g,l,v,a,A,R,B,W,X,m,J,he,T,U,C,ee,D]),ke=r.useCallback(()=>{switch(p){case"uploading":return`Uploading ${j||"file"}...`;case"creating":return Q?`Approving ${c}...`:Z?"Waiting for blockchain confirmation...":"Creating token on blockchain...";case"updating":return"Updating token in backend...";case"completed":return"Token created successfully!";case"error":return"Error occurred. Visit Portfolio to Update TokenInfo";default:return"Create Token"}},[p,Z,Q,c,j]),re=p!=="idle"||!n||!g||!l,je=()=>ce(!H);return r.useEffect(()=>{const t=o=>{(p==="creating"||p==="updating")&&(o.preventDefault(),o.returnValue="")};return window.addEventListener("beforeunload",t),()=>{window.removeEventListener("beforeunload",t)}},[p]),r.useEffect(()=>{V(p==="creating"||p==="updating")},[p]),e.jsxs(Ue,{children:[e.jsx(Me,{title:"Create Your Own Token - BondX",description:"Launch a coin that is instantly tradable without having to seed liquidity. - fair launch",image:"/seo/create.jpg"}),e.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-white mb-6 text-center",children:"Create New Token"}),e.jsxs("div",{className:"relative mb-6 flex justify-center",children:[e.jsxs("button",{type:"button",className:"text-gray-400 hover:text-[var(--primary)] transition-colors duration-200 flex items-center bg-[var(--card)] px-3 py-2 rounded-full",onMouseEnter:()=>q(!0),onMouseLeave:()=>q(!1),children:[e.jsx(ae,{className:"h-5 w-5 mr-2"}),e.jsx("span",{className:"text-[10px] sm:text-xs",children:"Deployment Cost Info"})]}),ue&&e.jsx("div",{className:"absolute left-1/2 transform -translate-x-1/2 top-12 bg-[var(--card2)] text-gray-400 p-4 rounded-md shadow-lg z-10 w-64 border border-[var(--card-boarder)]",children:e.jsx("p",{className:"text-[8px] sm:text-xs",children:"Cost to deploy: Only pay for gas ðŸ˜Ž"})})]}),e.jsxs("form",{onSubmit:ye,className:"space-y-6 bg-[var(--card)] p-4 sm:p-6 rounded-lg",children:[U&&!T&&C&&e.jsx("div",{className:"bg-yellow-900/20 border border-yellow-600/50 rounded-lg p-4 mb-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(ae,{className:"h-5 w-5 text-yellow-400 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-sm font-semibold text-yellow-400 mb-2",children:"Your Embedded Wallet Address"}),e.jsx("p",{className:"text-xs text-gray-300 mb-2",children:"Send ETH to this address to create tokens. This is your embedded wallet address."}),e.jsxs("div",{className:"bg-[var(--card2)] rounded-md p-3 mb-2",children:[e.jsx("p",{className:"text-xs text-gray-400 mb-1",children:"Address:"}),e.jsx("p",{className:"text-sm font-mono text-white break-all",children:C})]}),e.jsx("a",{href:`https://sepolia.basescan.org/address/${C}`,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-yellow-400 hover:text-yellow-300 underline",children:"View on BaseScan â†’"})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"tokenName",className:"block text-[10px] sm:text-xs font-medium text-gray-400 mb-1",children:"Token Name"}),e.jsx("input",{type:"text",id:"tokenName",value:n,onChange:t=>P(t.target.value),required:!0,className:"w-full py-2 px-3 bg-[var(--card2)] border border-[var(--card-boarder)] rounded-md text-white focus:outline-none focus:ring-2 focus:ring-[var(--primary)] focus:border-[var(--primary)] transition duration-150 ease-in-out",placeholder:"Enter token name"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"tokenSymbol",className:"block text-[10px] sm:text-xs font-medium text-gray-400 mb-1",children:"Token Symbol"}),e.jsx("input",{type:"text",id:"tokenSymbol",value:g,onChange:t=>b(t.target.value),required:!0,className:"w-full py-2 px-3 bg-[var(--card2)] border border-[var(--card-boarder)] rounded-md text-white focus:outline-none focus:ring-2 focus:ring-[var(--primary)] focus:border-[var(--primary)] transition duration-150 ease-in-out",placeholder:"Enter token symbol"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"tokenDescription",className:"block text-[10px] sm:text-xs font-medium text-gray-400 mb-1",children:"Token Description"}),e.jsx("textarea",{id:"tokenDescription",value:v,onChange:t=>F(t.target.value),rows:4,className:"w-full py-2 px-3 bg-[var(--card2)] border border-[var(--card-boarder)] rounded-md text-white focus:outline-none focus:ring-2 focus:ring-[var(--primary)] focus:border-[var(--primary)] transition duration-150 ease-in-out",placeholder:"Describe your token"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"tokenImage",className:"block text-[10px] sm:text-xs font-medium text-gray-400 mb-2",children:"Token Image or Video"}),e.jsx("div",{className:"mt-1 flex justify-center items-center px-4 py-4 border-2 border-[var(--card-boarder)] border-dashed rounded-md hover:border-[var(--primary)] transition duration-150 ease-in-out bg-[var(--card2)]",onDragOver:ge,onDrop:ve,children:e.jsx("div",{className:"space-y-1 text-center",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(We,{className:"mx-auto h-10 w-10 text-gray-400 mb-2"}),e.jsxs("div",{className:"flex flex-col sm:flex-row text-[9px] sm:text-sm text-gray-400 items-center",children:[e.jsxs("label",{htmlFor:"tokenImage",className:"cursor-pointer bg-[var(--card)] rounded-md font-medium text-[var(--primary)] hover:text-[var(--primary-hover)] focus-within:outline-none focus-within:ring-2 focus-within:ring-[var(--primary)] transition duration-150 ease-in-out px-3 py-2 mb-2 sm:mb-0 sm:mr-2",children:[e.jsx("span",{children:"Upload a file"}),e.jsx("input",{id:"tokenImage",name:"tokenImage",type:"file",accept:"image/*,video/*",className:"sr-only",onChange:be,disabled:_,ref:xe})]}),e.jsx("p",{children:"or drag and drop"})]}),e.jsx("p",{className:"text-xs text-gray-400 mt-2",children:"PNG, JPG, GIF, MP4, MOV up to 50MB"})]})})}),_&&e.jsxs("p",{className:"text-sm text-gray-400 mt-2",children:["Uploading ",j||"file","..."]})]}),l&&e.jsx("div",{className:"mt-4 flex justify-center",children:e.jsx("div",{className:"text-center",children:j==="video"?e.jsx("video",{src:l,controls:!0,className:"max-h-48 max-w-48 object-cover rounded-lg mx-auto border-2 border-[var(--primary)]",children:"Your browser does not support the video tag."}):e.jsx("img",{src:l,alt:"Token preview",className:"h-24 w-24 object-cover rounded-full mx-auto border-2 border-[var(--primary)]"})})}),e.jsxs("div",{className:"border border-[var(--card-boarder)] rounded-md overflow-hidden",children:[e.jsxs("button",{type:"button",onClick:je,className:"w-full flex justify-between items-center p-3 bg-[var(--card2)] text-white hover:bg-[var(--card-hover)] transition-colors duration-200",children:[e.jsx("span",{className:"font-medium text-[10px] sm:text-xs",children:"Social Media Links (Optional)"}),H?e.jsx(Ye,{className:"h-5 w-5"}):e.jsx($e,{className:"h-5 w-5"})]}),H&&e.jsx("div",{className:"p-4 bg-[var(--card)] grid grid-cols-1 sm:grid-cols-2 gap-4 text-[10px] sm:text-xs",children:[{id:"website",label:"Website",value:a,setter:I},{id:"telegram",label:"Telegram",value:A,setter:ne},{id:"discord",label:"Discord",value:R,setter:le},{id:"twitter",label:"Twitter",value:B,setter:ie},{id:"youtube",label:"YouTube",value:W,setter:de}].map(t=>e.jsxs("div",{children:[e.jsx("label",{htmlFor:t.id,className:"block text-[10px] sm:text-xs font-medium text-gray-400 mb-1",children:t.label}),e.jsx("input",{type:"url",id:t.id,value:t.value,onChange:o=>t.setter(o.target.value),className:"w-full py-2 px-3 bg-[var(--card2)] border border-[var(--card-boarder)] rounded-md text-white focus:outline-none focus:ring-2 focus:ring-[var(--primary)] focus:border-[var(--primary)] transition duration-150 ease-in-out",placeholder:"optional"})]},t.id))})]}),e.jsx("div",{children:e.jsx("button",{type:"submit",disabled:re,className:`w-full py-3 px-4 rounded-lg text-xs sm:text-sm font-medium transition duration-150 ease-in-out ${re?"bg-[var(--card-boarder)] text-gray-400 cursor-not-allowed":"bg-[var(--primary)] text-black hover:bg-[var(--primary-hover)]"}`,children:ke()})})]}),me&&e.jsx(Ke,{onConfirm:we,onCancel:()=>Y(!1),tokenSymbol:c,onTokenChange:t=>u(t)}),G&&e.jsx(qe,{isOpen:G,onClose:()=>{},children:e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-100 mb-4",children:"Please Wait"}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Your token is being ",p==="creating"?"created":"updated",". This process may take a few moments. Please do not navigate away or close the browser until the process is complete."]})]})})]})]})};export{ot as default};
